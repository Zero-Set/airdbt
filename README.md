# airdbt

airflow(未実装) x dbt x postgresの組み合わせです。
こんなゴリ押しのアーキテクトを組む人はいないと思いますが
なぜ、こんなものを作ってしまったのか。

## 目的(整理しきれてない駄文なので、参照しないこと)
通常、airflowやdbtを利用するためにはクラウドサービスの利用が必須であるが
コスト面を考えた時にどうしても採用できないところがあり、docker composeを使用した。

docker composeでairflowを立てたところで、
おそらく通常の考え方としては次の2種類の実装になるかと思う。
- クラウドサービスと連携する
- airflowのコンテナに無理やり実装を同居させる（今回のケースであればairflowとdbtを1つのコンテナで共存

不具合が起きそうなところ
docker composeのデフォルトネットワークのIPアドレスを直接dbt_profile.yamlにセットしている。
（そのため、いけてない。これやるくらいならoperatorを使って各クラウドサービスに繋いだほうが良い）

ということでdbtOperator出ないかな。。。（いや、作れやという話だがもう作られてるか？）

docker desktopではなくlimaを使っている関係上
/var/run/docker.sockのマウントを使っていない。


